* { box-sizing: border-box; }
:root {
  --bg: #0b0f1a;
  --bg2: #0f1424;
  --fg: #e6f1ff;
  --accent: #57c7ff;
  --accent2: #9bffb0;
  --danger: #ff6b6b;
}
html, body { height: 100%; }
body {
  margin: 0; background: radial-gradient(1200px 800px at 50% 30%, var(--bg2), var(--bg));
  color: var(--fg); font-family: system-ui, -apple-system, Segoe UI, Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", sans-serif;
  overscroll-behavior: none;
  touch-action: none;
}
#app { position: relative; width: 100%; height: 100vh; height: 100svh; height: 100dvh; overflow: hidden; display: grid; grid-template-rows: auto 1fr; }

/* 上下バー */
.bar { background: rgba(255,255,255,0.05); backdrop-filter: blur(4px); border-bottom: 1px solid rgba(255,255,255,0.12); }
.bottom-bar { display: none; }
.top-bar { padding: 8px 12px; padding-top: calc(8px + env(safe-area-inset-top)); }

/* ステージ（キャンバスを内部フィット） */
.stage { position: relative; overflow: hidden; }
#gameCanvas { display: block; width: 100%; height: 100%; background: transparent; }

/* ボスHP HUD */
.boss-hud { position: absolute; left: 0; right: 0; top: 16px; display: grid; place-items: center; pointer-events: none; z-index: 25; }
.boss-hud.hidden { display: none; }
.bossbar { display: flex; flex-direction: column; align-items: center; gap: 6px; }
.bossbar-label { font-weight: 800; letter-spacing: 2px; text-shadow: 0 2px 6px rgba(0,0,0,0.5); }
.bossbar-track { width: min(70vw, 520px); height: 14px; background: rgba(255,255,255,0.08); border-radius: 999px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.35) inset; }
.bossbar-fill { height: 100%; width: 100%; background: linear-gradient(90deg, #ffd166, #06d6a0); transition: width 120ms linear, background 160ms linear; }

.hud { display: flex; justify-content: space-between; align-items: center; font-weight: 600; text-shadow: 0 1px 2px rgba(0,0,0,0.5); }
.hud-left, .hud-right { display: flex; gap: 12px; align-items: center; }
.score, .highscore { background: rgba(255,255,255,0.06); padding: 4px 8px; border-radius: 8px; }
.health { display: flex; gap: 8px; align-items: center; }
.healthbar { width: 120px; height: 10px; background: rgba(255,255,255,0.08); border-radius: 999px; overflow: hidden; }
.healthbar-fill { height: 100%; background: linear-gradient(90deg, var(--accent2), #42d392); }

.btn { cursor: pointer; border: 0; border-radius: 10px; padding: 8px 12px; font-weight: 700; color: var(--bg); background: var(--fg); box-shadow: 0 4px 0 rgba(0,0,0,0.25); }
.btn.primary { background: linear-gradient(180deg, var(--accent), #2aa8e0); color: #002133; }
.btn.hidden { display: none; }
.btn:active { transform: translateY(1px); box-shadow: 0 3px 0 rgba(0,0,0,0.25); }

.overlay { position: absolute; inset: 0; display: grid; place-items: center; background: radial-gradient(800px 500px at 50% 30%, rgba(10,15,26,0.7), rgba(10,15,26,0.9)); z-index: 40; }
.overlay#stageModal { position: absolute; }
.overlay.hidden { display: none; }
.panel { background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.15); backdrop-filter: blur(6px); border-radius: 16px; padding: 24px; max-width: 600px; width: min(90vw, 560px); text-align: center; }
.settings-panel { text-align: left; }
.settings-form { display: flex; flex-direction: column; gap: 20px; margin: 20px 0; }
.settings-group { border: 1px solid rgba(255,255,255,0.18); border-radius: 12px; padding: 16px; }
.settings-group legend { font-weight: 700; padding: 0 8px; }
.settings-options { display: grid; gap: 12px; }
.settings-options.settings-modes { grid-template-columns: 1fr; }
.settings-options.settings-items { grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); }
.settings-option { display: flex; align-items: flex-start; gap: 10px; line-height: 1.5; font-size: 15px; }
.settings-option input { margin-top: 3px; accent-color: var(--accent); }
.settings-controls { display: flex; flex-wrap: wrap; gap: 12px; justify-content: center; margin-top: 8px; }
.title { margin: 0 0 8px; letter-spacing: 1px; }
.subtitle { margin: 0 0 16px; opacity: 0.85; }
.final-stats { margin-top: 12px; }

/* Touch area (invisible) */
#touchArea { position: absolute; inset: 0; }

/* Canvas aesthetic helpers */
.canvas-glow { filter: drop-shadow(0 0 12px rgba(87, 199, 255, 0.25)); }

/* Mobile fire button（右下固定） */
#fireBtn { position: fixed; right: max(12px, env(safe-area-inset-right)); bottom: calc(12px + env(safe-area-inset-bottom)); padding: 12px 16px; font-size: 16px; border-radius: 999px; opacity: 0.95; z-index: 30; }
/* デスクトップ（ポインタが細かくホバー可能）では非表示 */
@media (hover: hover) and (pointer: fine) {
  #fireBtn { display: none; }
}

/* 縦向き注意オーバーレイ */
.rotate-overlay { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(10,15,26,0.92); z-index: 50; text-align: center; padding: 24px; }
.rotate-overlay .panel { background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.15); border-radius: 16px; padding: 20px; }
